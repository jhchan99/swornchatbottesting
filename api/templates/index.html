<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Chatbot</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h1 class="text-3xl font-bold mb-8 text-gray-800 text-center">Content Assistant</h1>

            <div id="chat-container" class="space-y-6 mb-8 h-[500px] overflow-y-auto px-4">
                <!-- Messages will be inserted here -->
            </div>

            <div class="flex space-x-3 p-4 bg-gray-50 rounded-lg">
                <input
                    type="text"
                    id="user-input"
                    class="flex-1 p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 text-gray-700"
                    placeholder="Type your message here..."
                >
                <button
                    id="send-button"
                    class="bg-blue-500 text-white px-8 py-3 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400 font-medium transition-colors"
                >
                    Send
                </button>
            </div>
        </div>
    </div>

    <script>
        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');

        function addMessage(content, isUser) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `p-4 rounded-lg ${isUser ? 'bg-blue-100 ml-auto' : 'bg-gray-100'} max-w-[85%] whitespace-pre-wrap`;

            // Style the text
            const text = document.createElement('p');
            text.className = 'text-gray-800 leading-relaxed';
            text.textContent = content;

            messageDiv.appendChild(text);
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        async function sendMessage() {
            const message = userInput.value.trim();
            if (!message) return;

            // Add user message to chat
            addMessage(message, true);
            userInput.value = '';
            userInput.disabled = true;
            sendButton.disabled = true;

            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message }),
                });

                const data = await response.json();

                if (data.error) {
                    addMessage('Sorry, there was an error processing your request.', false);
                } else {
                    addMessage(data.response, false);
                }
            } catch (error) {
                addMessage('Sorry, there was an error connecting to the server.', false);
            }

            userInput.disabled = false;
            sendButton.disabled = false;
            userInput.focus();
        }

        sendButton.addEventListener('click', sendMessage);
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Add initial message
        addMessage('Hello! How can I help you today?', false);
    </script>
</body>
</html>